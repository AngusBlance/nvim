unbind r
bind r source-file ~/.config/tmux/tmux.conf

bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R
bind-key H previous-window
bind-key L next-window
bind s split-window -v -c "#{pane_current_path}"
bind v split-window -h -c "#{pane_current_path}"
bind-key p paste-buffer
unbind R
bind-key R command-prompt -I "#{window_name}" -p "Rename window:" 'rename-window -- "%%"'


set -g prefix ^B
set -g base-index 1
set -g renumber-windows on
setw -g mode-keys vi
# Make copy-mode feel like Vim visual selections
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi V send-keys -X select-line
bind-key -T copy-mode-vi C-v send-keys -X rectangle-toggle
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel
bind-key -T copy-mode-vi Y send-keys -X copy-line
bind-key -T copy-mode-vi Escape send-keys -X cancel

# Enable focus events so editors reload automatically; after reloading tmux, jump between panes to confirm buffers update on focus.
set -g focus-events on
# Remove the escape-key delay so prefix sequences feel snappy; drop this if you prefer the default pause.
set -sg escape-time 0
# Keep a larger scrollback so long-running commands stay in history.
set -g history-limit 10000
set -g set-clipboard on          # use system clipboard
set -g detach-on-destroy off     # don't exit from tmux when closing a session

set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-continuum'
set -g @plugin 'tmux-plugins/tmux-resurrect'

set -g @catppuccin_flavor 'frappe'
# Load Catppuccin theme files once plugins above are ready.
run '~/.config/tmux/plugins/catppuccin/tmux/catppuccin.tmux'
# Keep Catppuccin's rounded status segments but swap the hard block for a curved right edge.
set -g @catppuccin_status_fill "icon"
set -g @catppuccin_status_left_separator ""
set -g @catppuccin_status_middle_separator ""
set -g @catppuccin_status_right_separator ""
set -g @catppuccin_status_connect_separator "yes"
# Fast session switcher; `prefix + o` to launch SessionX.
# Keep window numbers but strip any duplicated index the shell may prepend.
set -g @catppuccin_window_text " #{s/^[0-9]+ +//:#{window_name}}"
set -g @catppuccin_window_current_text " #{s/^[0-9]+ +//:#{window_name}}"
set -g @catppuccin_window_number "#I"
set -g @catppuccin_window_current_number "#I"
# Trim gitmux output so branches drop the prefix and only show once.
set -g @catppuccin_gitmux_text ' #(~/.config/tmux/scripts/gitmux-status.sh "#{pane_current_path}")'

set -g @plugin 'omerxx/tmux-sessionx'
set -g @sessionx-bind 'o'
set -g @sessionx-custom-path '~/opal'
# status bar
set -g status-justify left
set -g status-position top
# Keep tmux auto-naming windows by the active command so Catppuccin shows something meaningful.
set -g automatic-rename on
set -g automatic-rename-format "#{b:pane_current_command}"
set -g status-style "bg=#{@thm_bg}"
set -g status-left ""
set -g status-right "#(~/.config/tmux/scripts/short-path.sh \"#{pane_current_path}\") #{E:@catppuccin_status_gitmux} #{E:@catppuccin_status_session}"
set -g status-right-length 120
# Ensure terminal advertises true-colour support inside tmux
set -g default-terminal "tmux-256color"
set -as terminal-overrides ',wezterm:RGB'

run '~/.config/tmux/plugins/tpm/tpm'
